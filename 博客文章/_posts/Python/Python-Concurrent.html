<!DOCTYPE HTML>
<html lang="cn" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Python-Concurrent - WhaleFall Obsidian Notes</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="Keep Notes everyday">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../../favicon.svg">
        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../../index.html"><strong aria-hidden="true">1.</strong> 落落的Notes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../SUMMARY.html"><strong aria-hidden="true">1.1.</strong> SUMMARY</a></li><li class="chapter-item expanded "><a href="../../../CutBoard/index.html"><strong aria-hidden="true">1.2.</strong> CutBoard</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../CutBoard/无线电爬取脚本.html"><strong aria-hidden="true">1.2.1.</strong> 无线电爬取脚本</a></li></ol></li><li class="chapter-item expanded "><a href="../../../博客文章/index.html"><strong aria-hidden="true">1.3.</strong> 博客文章</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../博客文章/博客文章测试.html"><strong aria-hidden="true">1.3.1.</strong> 博客文章测试</a></li><li class="chapter-item expanded "><a href="../../../博客文章/博客文章_post.html"><strong aria-hidden="true">1.3.2.</strong> 博客文章_post</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/index.html"><strong aria-hidden="true">1.3.3.</strong> _posts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../博客文章/_posts/openwebrx-sdr.html"><strong aria-hidden="true">1.3.3.1.</strong> openwebrx-sdr</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Rpi-3.html"><strong aria-hidden="true">1.3.3.2.</strong> Rpi-3</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Samba4-config.html"><strong aria-hidden="true">1.3.3.3.</strong> Samba4-config</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Linux-note.html"><strong aria-hidden="true">1.3.3.4.</strong> Linux-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Kali-Linux-Help.html"><strong aria-hidden="true">1.3.3.5.</strong> Kali-Linux-Help</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Rpi-1.html"><strong aria-hidden="true">1.3.3.6.</strong> Rpi-1</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Hexo-blog-format.html"><strong aria-hidden="true">1.3.3.7.</strong> Hexo-blog-format</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Freedom-network.html"><strong aria-hidden="true">1.3.3.8.</strong> Freedom-network</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Vim-config.html"><strong aria-hidden="true">1.3.3.9.</strong> Vim-config</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/clash-proxy-guide.html"><strong aria-hidden="true">1.3.3.10.</strong> clash-proxy-guide</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Github-workflow.html"><strong aria-hidden="true">1.3.3.11.</strong> Github-workflow</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Linux-iptables.html"><strong aria-hidden="true">1.3.3.12.</strong> Linux-iptables</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/onedrive-guide.html"><strong aria-hidden="true">1.3.3.13.</strong> onedrive-guide</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/openwrt-lede-build-notes.html"><strong aria-hidden="true">1.3.3.14.</strong> openwrt-lede-build-notes</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Depression-medicine.html"><strong aria-hidden="true">1.3.3.15.</strong> Depression-medicine</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Wky-help.html"><strong aria-hidden="true">1.3.3.16.</strong> Wky-help</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/radio-SWshort.html"><strong aria-hidden="true">1.3.3.17.</strong> radio-SWshort</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Server-all.html"><strong aria-hidden="true">1.3.3.18.</strong> Server-all</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Rpi-2.html"><strong aria-hidden="true">1.3.3.19.</strong> Rpi-2</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Study/index.html"><strong aria-hidden="true">1.3.3.20.</strong> Study</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Study/Ancient-poems.html"><strong aria-hidden="true">1.3.3.20.1.</strong> Ancient-poems</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Study/Zhongkao-maths.html"><strong aria-hidden="true">1.3.3.20.2.</strong> Zhongkao-maths</a></li></ol></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Python/index.html"><strong aria-hidden="true">1.3.3.21.</strong> Python</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Python/Python-Generator-Iterator-decorater.html"><strong aria-hidden="true">1.3.3.21.1.</strong> Python-Generator-Iterator-decorater</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Python/Python-async.html"><strong aria-hidden="true">1.3.3.21.2.</strong> Python-async</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Python/Flask-Web-note.html"><strong aria-hidden="true">1.3.3.21.3.</strong> Flask-Web-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Python/Python-Concurrent.html" class="active"><strong aria-hidden="true">1.3.3.21.4.</strong> Python-Concurrent</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Python/Python-Tkinter-GUI.html"><strong aria-hidden="true">1.3.3.21.5.</strong> Python-Tkinter-GUI</a></li></ol></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/index.html"><strong aria-hidden="true">1.3.3.22.</strong> Golang</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-const-note.html"><strong aria-hidden="true">1.3.3.22.1.</strong> Golang-const-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-goruntine-note.html"><strong aria-hidden="true">1.3.3.22.2.</strong> Golang-goruntine-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-package-note.html"><strong aria-hidden="true">1.3.3.22.3.</strong> Golang-package-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-interface-note.html"><strong aria-hidden="true">1.3.3.22.4.</strong> Golang-interface-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-project-and-gomod-note.html"><strong aria-hidden="true">1.3.3.22.5.</strong> Golang-project-and-gomod-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-error-note.html"><strong aria-hidden="true">1.3.3.22.6.</strong> Golang-error-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-method-note.html"><strong aria-hidden="true">1.3.3.22.7.</strong> Golang-method-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-envbuild-note.html"><strong aria-hidden="true">1.3.3.22.8.</strong> Golang-envbuild-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-datatype-note.html"><strong aria-hidden="true">1.3.3.22.9.</strong> Golang-datatype-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-function-note.html"><strong aria-hidden="true">1.3.3.22.10.</strong> Golang-function-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-type-keyword-note.html"><strong aria-hidden="true">1.3.3.22.11.</strong> Golang-type-keyword-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-HTML-note.html"><strong aria-hidden="true">1.3.3.22.12.</strong> Golang-HTML-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-variable-note.html"><strong aria-hidden="true">1.3.3.22.13.</strong> Golang-variable-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-pointer-note.html"><strong aria-hidden="true">1.3.3.22.14.</strong> Golang-pointer-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-JSON-note.html"><strong aria-hidden="true">1.3.3.22.15.</strong> Golang-JSON-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-id-note.html"><strong aria-hidden="true">1.3.3.22.16.</strong> Golang-id-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-struct-note.html"><strong aria-hidden="true">1.3.3.22.17.</strong> Golang-struct-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-map-note.html"><strong aria-hidden="true">1.3.3.22.18.</strong> Golang-map-note</a></li><li class="chapter-item expanded "><a href="../../../博客文章/_posts/Golang/Golang-note-catalogue.html"><strong aria-hidden="true">1.3.3.22.19.</strong> Golang-note-catalogue</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../English-Study/index.html"><strong aria-hidden="true">1.4.</strong> English-Study</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../English-Study/英语音标学习.html"><strong aria-hidden="true">1.4.1.</strong> 英语音标学习</a></li></ol></li><li class="chapter-item expanded "><a href="../../../Study/index.html"><strong aria-hidden="true">1.5.</strong> Study</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Study/Physical/index.html"><strong aria-hidden="true">1.5.1.</strong> Physical</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Study/Physical/第5讲-力的正交分解.html"><strong aria-hidden="true">1.5.1.1.</strong> 第5讲-力的正交分解</a></li><li class="chapter-item expanded "><a href="../../../Study/Physical/第二讲-比例问题.html"><strong aria-hidden="true">1.5.1.2.</strong> 第二讲-比例问题</a></li><li class="chapter-item expanded "><a href="../../../Study/Physical/第六讲.html"><strong aria-hidden="true">1.5.1.3.</strong> 第六讲</a></li><li class="chapter-item expanded "><a href="../../../Study/Physical/第7讲.html"><strong aria-hidden="true">1.5.1.4.</strong> 第7讲</a></li><li class="chapter-item expanded "><a href="../../../Study/Physical/第一讲-运动的描述.html"><strong aria-hidden="true">1.5.1.5.</strong> 第一讲-运动的描述</a></li></ol></li><li class="chapter-item expanded "><a href="../../../Study/Chemistry/index.html"><strong aria-hidden="true">1.5.2.</strong> Chemistry</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Study/Chemistry/第一讲-离子反应的基础概念.html"><strong aria-hidden="true">1.5.2.1.</strong> 第一讲-离子反应的基础概念</a></li></ol></li><li class="chapter-item expanded "><a href="../../../Study/Math/index.html"><strong aria-hidden="true">1.5.3.</strong> Math</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Study/Math/函数.html"><strong aria-hidden="true">1.5.3.1.</strong> 函数</a></li><li class="chapter-item expanded "><a href="../../../Study/Math/第一讲-集合与常用逻辑用语.html"><strong aria-hidden="true">1.5.3.2.</strong> 第一讲-集合与常用逻辑用语</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../other/index.html"><strong aria-hidden="true">1.6.</strong> other</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../other/OPENAI-KEY.html"><strong aria-hidden="true">1.6.1.</strong> OPENAI-KEY</a></li><li class="chapter-item expanded "><a href="../../../other/未命名.html"><strong aria-hidden="true">1.6.2.</strong> 未命名</a></li><li class="chapter-item expanded "><a href="../../../other/写给v友的一段话.html"><strong aria-hidden="true">1.6.3.</strong> 写给v友的一段话</a></li><li class="chapter-item expanded "><a href="../../../other/模拟飞行.html"><strong aria-hidden="true">1.6.4.</strong> 模拟飞行</a></li></ol></li><li class="chapter-item expanded "><a href="../../../业余无线电Ham/index.html"><strong aria-hidden="true">1.7.</strong> 业余无线电Ham</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../业余无线电Ham/通联日志.html"><strong aria-hidden="true">1.7.1.</strong> 通联日志</a></li><li class="chapter-item expanded "><a href="../../../业余无线电Ham/Opengd77-Firmware-教程.html"><strong aria-hidden="true">1.7.2.</strong> Opengd77-Firmware-教程</a></li><li class="chapter-item expanded "><a href="../../../业余无线电Ham/广播.html"><strong aria-hidden="true">1.7.3.</strong> 广播</a></li><li class="chapter-item expanded "><a href="../../../业余无线电Ham/泉盛-K5-音质优化.html"><strong aria-hidden="true">1.7.4.</strong> 泉盛-K5-音质优化</a></li><li class="chapter-item expanded "><a href="../../../业余无线电Ham/业余无线电笔记.html"><strong aria-hidden="true">1.7.5.</strong> 业余无线电笔记</a></li><li class="chapter-item expanded "><a href="../../../业余无线电Ham/业余无线电采购.html"><strong aria-hidden="true">1.7.6.</strong> 业余无线电采购</a></li><li class="chapter-item expanded "><a href="../../../业余无线电Ham/附近航空频率.html"><strong aria-hidden="true">1.7.7.</strong> 附近航空频率</a></li><li class="chapter-item expanded "><a href="../../../业余无线电Ham/广播/index.html"><strong aria-hidden="true">1.7.8.</strong> 广播</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../业余无线电Ham/广播/广播收听报告-2023.05.23.html"><strong aria-hidden="true">1.7.8.1.</strong> 广播收听报告-2023.05.23</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../test/index.html"><strong aria-hidden="true">1.8.</strong> test</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../test/落落-OpenWRT-导航页.html"><strong aria-hidden="true">1.8.1.</strong> 落落-OpenWRT-导航页</a></li><li class="chapter-item expanded "><a href="../../../test/思源笔记自动同步测试.html"><strong aria-hidden="true">1.8.2.</strong> 思源笔记自动同步测试</a></li><li class="chapter-item expanded "><a href="../../../test/Obsidian-Hexo-模板测试.html"><strong aria-hidden="true">1.8.3.</strong> Obsidian-Hexo-模板测试</a></li></ol></li><li class="chapter-item expanded "><a href="../../../高中事件/index.html"><strong aria-hidden="true">1.9.</strong> 高中事件</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../高中事件/举报中小学教师违规方法论.html"><strong aria-hidden="true">1.9.1.</strong> 举报中小学教师违规方法论</a></li><li class="chapter-item expanded "><a href="../../../高中事件/举报法律依据.html"><strong aria-hidden="true">1.9.2.</strong> 举报法律依据</a></li><li class="chapter-item expanded "><a href="../../../高中事件/举报信.html"><strong aria-hidden="true">1.9.3.</strong> 举报信</a></li></ol></li><li class="chapter-item expanded "><a href="../../../碎碎念/index.html"><strong aria-hidden="true">1.10.</strong> 碎碎念</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../碎碎念/freedom.html"><strong aria-hidden="true">1.10.1.</strong> freedom</a></li><li class="chapter-item expanded "><a href="../../../碎碎念/猫猫.html"><strong aria-hidden="true">1.10.2.</strong> 猫猫</a></li><li class="chapter-item expanded "><a href="../../../碎碎念/文案.html"><strong aria-hidden="true">1.10.3.</strong> 文案</a></li><li class="chapter-item expanded "><a href="../../../碎碎念/奇思妙想.html"><strong aria-hidden="true">1.10.4.</strong> 奇思妙想</a></li><li class="chapter-item expanded "><a href="../../../碎碎念/闲鱼文案模板.html"><strong aria-hidden="true">1.10.5.</strong> 闲鱼文案模板</a></li><li class="chapter-item expanded "><a href="../../../碎碎念/记录.html"><strong aria-hidden="true">1.10.6.</strong> 记录</a></li><li class="chapter-item expanded "><a href="../../../碎碎念/思源笔记本使用感想.html"><strong aria-hidden="true">1.10.7.</strong> 思源笔记本使用感想</a></li><li class="chapter-item expanded "><a href="../../../碎碎念/知乎精选.html"><strong aria-hidden="true">1.10.8.</strong> 知乎精选</a></li><li class="chapter-item expanded "><a href="../../../碎碎念/猫猫/index.html"><strong aria-hidden="true">1.10.9.</strong> 猫猫</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../碎碎念/猫猫/多多.html"><strong aria-hidden="true">1.10.9.1.</strong> 多多</a></li></ol></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">WhaleFall Obsidian Notes</h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <hr />
<p>title: Python 并发编程笔记
date: 2021-06-18 19:37:48
updated: 2021-06-18 19:37:48
categories: Python
tags: [Python, Coding]
description: Python并发编程(多线程,多进程,多协程)
thumbnail: http://oss.whaleluo.top/blog/old/20210630201524.png
banner_img: http://oss.whaleluo.top/blog/old/20210630201524.png</p>
<hr />
<h1 id="python-并发编程"><a class="header" href="#python-并发编程">Python 并发编程</a></h1>
<h2 id="各并发技术"><a class="header" href="#各并发技术">各并发技术</a></h2>
<p><img src="http://oss.whaleluo.top/blog/old/20210630200927.png-picsmall" alt="" /></p>
<h2 id="1-多线程-threadthreading"><a class="header" href="#1-多线程-threadthreading">1. 多线程 Thread（threading）</a></h2>
<blockquote>
<ul>
<li>
<p>优点：<strong>相比进程，更轻量级、占用资源少.</strong></p>
</li>
<li>
<p>缺点：</p>
<ul>
<li>相比进程：多线程只能<strong>并发执行</strong>，<strong>不能利用多 CPU（GIL）</strong></li>
<li>相比协程：启动数目<strong>有限制</strong>，占用内存资源，<strong>有线程切换开销</strong></li>
</ul>
</li>
<li>
<p>适用于：<strong>IO 密集型计算</strong>、同时运行的任务数目要求不多</p>
</li>
</ul>
</blockquote>
<h3 id="多进程普通写法"><a class="header" href="#多进程普通写法">多进程普通写法</a></h3>
<pre><code class="language-python">import threading
threads = [] # 线程列表

# 为每个url创建一个线程对象并加入线程列表里
# target: 函数名 args: 函数参数(元组格式)
for url in urls:
    threads.append(
        threading.Thread(target=craw, args=(url,))
    )

# 遍历线程列表启动线程
for thread in threads:
    thread.start()

# 等待线程结束再执行主线程
for thread in threads:
    thread.join()
</code></pre>
<h3 id="利用线程池技术"><a class="header" href="#利用线程池技术">利用线程池技术</a></h3>
<blockquote>
<p>好处: 新建线程系统需要<strong>分配资源</strong>、终止线程系统需要回收资源,线程池可以<strong>重用线程</strong>，则可以<strong>减去新建/终止的开销</strong></p>
</blockquote>
<ul>
<li>
<p>原理</p>
<p><img src="http://oss.whaleluo.top/blog/old/20210630204323.png-picsmall" alt="" /></p>
<p><img src="http://oss.whaleluo.top/blog/old/20210630204353.png-picsmall" alt="" /></p>
</li>
<li>
<p>代码实现</p>
<ol>
<li><strong>map 方式提交</strong></li>
</ol>
<blockquote>
<p><code>map</code> 的结果和入参是顺序对应的,且 map 传入函数参数时要传入<strong>参数列表</strong></p>
</blockquote>
<blockquote>
<p><a href="https://www.runoob.com/python3/python3-func-zip.html">Python Zip()函数</a>
&gt;&gt;
&gt;&gt;</p>
<blockquote>
<p><strong>zip()</strong> 函数用于将<strong>可迭代的对象作为参数</strong>，将对象中<strong>对应的元素打包成一个个元组</strong>，然后返回由这些<strong>元组组成的对象</strong>，这样做的好处是<strong>节约了不少的内存</strong>。</p>
<p>我们可以使用 <code>list()</code> 转换来输出列表。</p>
<p><strong>元素个数与最短的列表一致</strong>.</p>
<p>如果各个迭代器的元素个数不一致，则返回列表长度与最短的对象相同，利用 ***** 号操作符，可以将元组解压为列表。</p>
</blockquote>
</blockquote>
</li>
</ul>
<blockquote>
<p><img src="http://oss.whaleluo.top/blog/old/20210630211154.png-picsmall" alt="&quot;形象&quot;" /></p>
</blockquote>
<pre><code class="language-python">
from concurrent.futures import ThreadPoolExecutor
# 可以设置线程数
with ThreadPoolExecutor(max_workers=10) as pool:
    # map 向线程池提交任务,传入方法名,以及参数列表
    htmls = pool.map(craw, urls)
    # htmls urls(列表) 都是可迭代对象,可以用 zip 函数将他们打包成一个元组
    htmls = list(zip(urls, htmls))
    # 结果和入参是顺序对应的
    for url, html in htmls:
        print(url, len(html))
</code></pre>
<ol>
<li><strong>submit 方式提交</strong></li>
</ol>
<blockquote>
<p><strong>future 模式，更强大</strong>,注意如果用 <code>as_completed</code> 顺序是不定的</p>
</blockquote>
<blockquote>
<p><a href="https://www.runoob.com/python3/python3-att-dictionary-items.html">Python3 字典 items方法</a></p>
<blockquote>
<p>Python 字典 items() 方法以列表<strong>返回视图对象</strong>，是一个<strong>可遍历的 key/value 对</strong>。</p>
</blockquote>
<p>将: <code>{'Name': 'Runoob', 'Age': 7}</code> 变为: <code>[('Age', 7), ('Name', 'Runoob')]</code></p>
</blockquote>
<ul>
<li>
<p><strong>方法一</strong></p>
<pre><code class="language-python">from concurrent.futures import ThreadPoolExecutor,as_completed
with ThreadPoolExecutor() as pool:
    # 利用线程列表启动
    futures=[
        pool.submit(craw,url)
        for url in urls
    ]

    # 通过遍历线程列表取出结果(要等所有结果运行完才有)
    for future in futures:
        print(future.result())

    # as_completed 不需要等待所有结果运行完才输出结果
    # 一旦有结果运行完就会输出
    for future in as_completed(futures):
        print(future.result())
</code></pre>
</li>
<li>
<p><strong>方法二</strong></p>
<blockquote>
<p><strong>适合需要与某一个量一一对应建立联系</strong></p>
</blockquote>
<pre><code class="language-python">from concurrent.futures import ThreadPoolExecutor
with ThreadPoolExecutor() as pool:
    futures = {}  # 字典,便于一一对应
    # htmls格式: ([],[],[],..)
    # 遍历元组的每个列表,把列表中的两个参数赋值给 url,html
    for url, html in htmls:
        # submwit 提交,传入方法名和单个参数
        future = pool.submit(parse, html)
        # 使用字典 将 future 对象与链接一一对应
        futures[future] = url

    # 将转化为元组的字典遍历出来
    # future-&gt;线程对象 url-&gt;线程对应的url
    for future,url in futures.items():
        # 线程对象通过 result 取出运行结果
        print(url,future.result())
</code></pre>
</li>
</ul>
<h3 id="生产者消费者模型--producer-consumer"><a class="header" href="#生产者消费者模型--producer-consumer">生产者消费者模型 ( Producer, Consumer)</a></h3>
<ol>
<li>
<p>多组件的 <code>Pipeline</code> 技术架构</p>
<blockquote>
<p>复杂的事情一般都不会一下子做完，而是会分<strong>很多中间步骤一步步完成</strong></p>
</blockquote>
<p><img src="http://oss.whaleluo.top/blog/old/20210703065209.png-picsmall" alt="" /></p>
<p><img src="http://oss.whaleluo.top/blog/old/20210703065255.png-picsmall" alt="" /></p>
</li>
<li>
<p><strong>多线程数据通信的</strong>​**<code>queue.Queue</code>**</p>
<blockquote>
<p><code>queue.Queue</code> 可以用于<strong>多线程之间</strong>的、<strong>线程安全</strong>的数据通信</p>
<p><strong>多个线程</strong> 可以 <strong>同时</strong> 读取 <strong>同一个队列</strong></p>
</blockquote>
<pre><code class="language-python"># 1、导入类库
import queue
# 2、创建Queue
q = queue.Queue()
# 3、添加元素
q.put(item)
# 4、获取元素
item = q.get()
# 5、查询状态
# 查看元素的多少
q.qsize()
# 判断是否为空
q.empty()
# 判断是否已满
q.full()
</code></pre>
</li>
<li>
<p>实例:</p>
<pre><code class="language-python">import threading
import queue
import random,time

# 传入 url 队列 和 Html 队列
def do_craw(url_queue: queue.Queue, html_queue: queue.Queue):
    while True:
        # 从 Url 队列里获取一个链接
        url = url_queue.get()
        html = blog_spider.craw(url)
        # 将获取到的 html 内容放入 html 队列
        html_queue.put(html)
        # current_thead: 当前线程 .name: 获取线程的名字
        print(threading.current_thread().name, f&quot;craw {url}&quot;,
              &quot;url_queue.size=&quot;, url_queue.qsize())
        time.sleep(random.randint(1, 2))


def do_parse(html_queue: queue.Queue, fout):
    while True:
        html = html_queue.get()
        results = blog_spider.parse(html)
        for result in results:
            fout.write(str(result) + &quot;\n&quot;)
        print(threading.current_thread().name, f&quot;results.size&quot;, len(results),
              &quot;html_queue.size=&quot;, html_queue.qsize())
        time.sleep(random.randint(1, 2))


if __name__ == &quot;__main__&quot;:
    url_queue = queue.Queue() # 链接队列
    html_queue = queue.Queue() # Html 文件队列
    # 将所有链接添加到链接队列里面
    for url in urls:
        url_queue.put(url)

    # 创建链接访问线程
    for idx in range(3):
        t = threading.Thread(target=do_craw, args=(url_queue, html_queue),
                             name=f&quot;craw{idx}&quot;)
        t.start()

    # 创建 HTML 解析线程
    fout = open(&quot;02.data.txt&quot;, &quot;w&quot;)
    for idx in range(2):
        # name: 设置线程的名字.
        t = threading.Thread(target=do_parse, args=(html_queue, fout),
                             name=f&quot;parse{idx}&quot;)
        t.start()

</code></pre>
</li>
</ol>
<h2 id="2-多进程-multiprocess"><a class="header" href="#2-多进程-multiprocess">2. 多进程 (MultiProcess)</a></h2>
<h3 id="全局解释器锁-python-的大缺点"><a class="header" href="#全局解释器锁-python-的大缺点">全局解释器锁 (Python 的大缺点)</a></h3>
<ol>
<li><strong>任何时刻仅有一个线程</strong>在执行。</li>
<li>在<strong>多核心处理器上</strong>，使用 GIL 的解释器也只允许同一时间执行一个线程</li>
<li>GIL 目的：为了解决多线程之间<strong>数据完整性</strong>和状态同步问题</li>
<li>GIL 带来的<strong>问题</strong></li>
</ol>
<ul>
<li>即使使用了多线程，同一时刻也只有<strong>单个线程使用 CPU</strong>，导致多核 CPU 的浪费</li>
<li>GIL 只会对<strong>CPU 密集型</strong>的程序产生影响</li>
<li>如果程序主要是在做<strong>I/O 操作</strong>，比如<strong>处理网络连接</strong>，那么<strong>多线程技术</strong>常常是一个明智的选择</li>
</ul>
<ol>
<li><strong>规避 GIL</strong>的方法</li>
</ol>
<ul>
<li>规避方法 2： 使用 <code>multiprocessing</code> 多进程，对 CPU 密集型计算，单独启动子进程解释器去执行</li>
<li>规避方法 2： ﻿将计算密集型的任务转移到<strong>C 语言</strong>中，因为 C 语言比 Python 快得多，注意要在 C 语言中自己释放 GIL</li>
</ul>
<p><img src="http://oss.whaleluo.top/blog/old/20210701000441.png-picsmall" alt="" /></p>
<blockquote>
<h3 id="多进程适用于-cpu-密集型计算"><a class="header" href="#多进程适用于-cpu-密集型计算">多进程适用于 CPU 密集型计算</a></h3>
<p>多进程的 API 与 <strong>多线程的实现十分类似</strong></p>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">语法条目</th><th style="text-align: center">多线程</th><th style="text-align: center">多进程</th></tr></thead><tbody>
<tr><td style="text-align: left">引入模块</td><td style="text-align: center">from threading import Thread</td><td style="text-align: center">from multiprocessing import Process</td></tr>
<tr><td style="text-align: left">新建  启动  等待结束</td><td style="text-align: center">t=Thread(target=func, args=(100, ))  t.start()  t.join()</td><td style="text-align: center">p = Process(target=f, args=('bob',))  p.start()  p.join()</td></tr>
<tr><td style="text-align: left">数据通信</td><td style="text-align: center">import queue  q = queue.Queue()  q.put(item)  item = q.get()</td><td style="text-align: center">from multiprocessing import Queue  q = Queue()  q.put([42, None, 'hello'])  item = q.get()</td></tr>
<tr><td style="text-align: left">线程安全加锁</td><td style="text-align: center">from threading import Lock  lock = Lock()  with lock:      # do something</td><td style="text-align: center">from multiprocessing import Lock  lock = Lock()  with lock:      # do something</td></tr>
<tr><td style="text-align: left">池化技术</td><td style="text-align: center">from concurrent.futures import  ThreadPoolExecutor    with ThreadPoolExecutor() as executor:      # 方法 1      results = executor.map(func, [1,2,3])        # 方法 2      future = executor.submit(func, 1)      result = future.result()</td><td style="text-align: center">from concurrent.futures import ProcessPoolExecutor    with ProcessPoolExecutor() as executor:      # 方法 1      results = executor.map(func, [1,2,3])        # 方法 2      future = executor.submit(func, 1)      result = future.result()</td></tr>
</tbody></table>
</div>
<h3 id="利用进程池技术实现多进程"><a class="header" href="#利用进程池技术实现多进程"><strong>利用进程池技术实现多进程</strong></a></h3>
<pre><code class="language-python">from concurrent.futures import ProcessPoolExecutor
import time

def test(lover):
    print(&quot;我喜欢:&quot;, lover)
    time.sleep(1)

# 任何池化技术都需要写程序入口
if __name__ == &quot;__main__&quot;:
    # 喜欢的人列表
    lovers = [&quot;颖怡&quot;, &quot;菲菲&quot;, &quot;詹天佑&quot;]
    start_time = time.time()
    # 1. 使用 map 方式提交
    with ProcessPoolExecutor(max_workers=10) as pool:
        # map 方式提交进程池需要传入函数名和多参数元组
        pool.map(test, lovers)

    # 2. 使用 submit 方式提交
    with ProcessPoolExecutor() as pool:
        # 利用进程列表启动
        futures=[
            pool.submit(test,lover)
            for lover in lovers
        ]

    end_time = time.time()
    print(&quot;cost Time:&quot;, end_time-start_time)
</code></pre>
<h2 id="3-并发锁-concurrent-lock"><a class="header" href="#3-并发锁-concurrent-lock">3. 并发锁 (Concurrent Lock)</a></h2>
<blockquote>
<p><strong>线程安全</strong>指某个函数、函数库在<strong>多线程环境</strong>中被调用时，能够正确地处理多个线程之间的<strong>共享变量</strong>，使程序功能正确完成。</p>
<p>由于<strong>线程的执行随时会发生切换</strong>，就造成了不可预料的结果，出现<strong>线程不安全</strong>(简单来说就是程序串行)</p>
</blockquote>
<p><img src="http://oss.whaleluo.top/blog/old/20210702130844.png-picsmall" alt="" /></p>
<pre><code class="language-python">import threading
# 实例化锁对象
lock = threading.Lock()
# 上锁
lock.locked()
# 释放锁
lock.release()
</code></pre>
<h3 id="用法-1-try-finally-模式"><a class="header" href="#用法-1-try-finally-模式">用法 1: <code>try-finally</code> 模式</a></h3>
<pre><code class="language-python">import threading
lock = threading.Lock()
lock.acquire()
try:
    # do something
finally:
    lock.release()
</code></pre>
<h3 id="用法-2-with-模式-推荐这种方式"><a class="header" href="#用法-2-with-模式-推荐这种方式">用法 2: <code>with</code> 模式 <strong>(推荐这种方式)</strong></a></h3>
<pre><code class="language-python">import threading
lock = threading.Lock()
with lock:
    # do something
</code></pre>
<h3 id="什么时候需要上锁"><a class="header" href="#什么时候需要上锁">什么时候需要上锁</a></h3>
<blockquote>
<p><strong>多人读,不需要|一读一写要加|多人写要加</strong></p>
</blockquote>
<p>只是操作<strong>共享变量</strong>部分的代码要<strong>上锁</strong>,而不是多线程中所有代码都要上锁,并<strong>不影响多线程</strong>的执行效果.</p>
<p><img src="http://oss.whaleluo.top/blog/old/20210702143102.png-picsmall" alt="image-20210702143100587" /></p>
<h2 id="4-异步协程"><a class="header" href="#4-异步协程">4. 异步协程</a></h2>
<h3 id="原理"><a class="header" href="#原理">原理</a></h3>
<blockquote>
<p>同步：执行 IO 操作时，<strong>必须等待执行完成才得到返回结果</strong>。<br />
异步：执行 IO 操作时，<strong>不必等待执行就能得到返回结果</strong>。</p>
</blockquote>
<p><img src="http://oss.whaleluo.top/blog/old/20210702150837.jpeg-picsmall" alt="" /></p>
<p><img src="http://oss.whaleluo.top/blog/old/20210702143833.png-picsmall" alt="image-20210702143832079" /></p>
<blockquote>
<p>注意：要用在<strong>异步 IO 编程中</strong>,依赖的<strong>库必须支持异步 IO 特性.</strong></p>
<p>爬虫引用中：<code>requests</code> 不支持异步|需要用 <code>aiohttp</code></p>
</blockquote>
<h3 id="补充"><a class="header" href="#补充">补充</a></h3>
<h4 id="1-什么是协程异步"><a class="header" href="#1-什么是协程异步">1. 什么是协程、异步</a></h4>
<p>举个例子：假设有 1 个洗衣房，里面有 10 台洗衣机，有一个洗衣工在负责这 10 台洗衣机。那么<strong>洗衣房就相当于 1 个进程</strong>，洗衣工就相当<strong>1 个线程</strong>。如果有 10 个洗衣工，就相当于<strong>10 个线程</strong>，<strong>1 个进程是可以开多线程的</strong>。这就是多线程！</p>
<p>那么协程呢？先不急。大家都知道，洗衣机洗衣服是<strong>需要等待时间</strong>的，如果 10 个洗衣工，1 人负责 1 台洗衣机，这样效率肯定会提高，但是不觉得<strong>浪费资源</strong>吗？明明 1 个人能做的事，却要 10 个人来做。只是把衣服放进去，打开开关，<strong>就没事做</strong>了，等衣服洗好再拿出来就可以了。就算很多人来洗衣服，<strong>1 个人也足以应付了</strong>，开好第一台洗衣机，在等待的时候去<strong>开第二台洗衣机，再开第三台</strong>，……直到有衣服洗好了，就回来把衣服取出来，接着<strong>再取另一台</strong>的（哪台洗好先就取哪台，所以<strong>协程是无序的</strong>）。这就是计算机的协程！洗衣机就是<strong>执行的方法</strong>。</p>
<p>当你程序中方法需要等待时间的话，就可以用<strong>协程</strong>，<strong>效率高，消耗资源少。</strong></p>
<p><strong>洗衣房 ==&gt; 进程 | 洗衣工 ==&gt; 线程 | 洗衣机 ==&gt; 方法 (函数)</strong></p>
<h4 id="2-async--await-的使用"><a class="header" href="#2-async--await-的使用">2. <code>async</code> \ <code>await</code> 的使用</a></h4>
<p>正常的函数在执行时是<strong>不会中断</strong>的，所以你要写一个<strong>能够中断</strong>的函数，就需要添加 <code>async</code> 关键字。</p>
<p><code>async</code> 用来声明一个函数为异步函数，异步函数的特点是<strong>能在函数执行过程中挂起，去执行其他异步函数</strong>，等到<strong>挂起条件</strong>（假设挂起条件是 sleep(5)）消失后，也就是 5 秒到了<strong>再回来执行</strong>。</p>
<p><code>await</code> 用来用来声明<strong>程序挂起</strong>，比如异步程序执行到<strong>某一步时需要等待的时间很长，就将此挂起</strong>，去<strong>执行其他的异步程序</strong>。<code>await</code> 后面只能跟 <strong>异步函数</strong> 或有 <code>__await__</code> 属性的对象，因为<strong>异步程序与一般程序不同</strong>。</p>
<p>假设有两个异步函数 <code>async a，async b</code>，a 中的某一步有 <code>await</code>，当程序碰到关键字 <code>await b()</code> 后，异步程序挂起后去执行另一个异步 b 程序，就是从<strong>函数内部跳出去执行其他函数</strong>，<strong>当挂起条件消失后，不管 b 是否执行完，要马上从 b 程序中跳出来</strong>，<strong>回到原程序执行原来</strong>的操作。如果 await 后面跟的<strong>b 函数不是异步函数</strong>，那么操作就<strong>只能等 b 执行完再返回</strong>，无法在<strong>b 执行的过程中返回</strong>。如果要在<strong>b 执行完</strong>才返回，也就<strong>不需要用 await 关键字了</strong>，直接<strong>调用 b 函数</strong>就行。所以这就需要 <code>await</code> 后面跟的是<strong>异步函数</strong>了。在一个异步函数中，可以<strong>不止一次挂起</strong>，也就是可以用多个 <code>await</code>。</p>
<h3 id="基本实现"><a class="header" href="#基本实现"><strong>基本实现:</strong></a></h3>
<blockquote>
<ul>
<li>
<ol>
<li>在普通的函数前面加 <strong>async</strong> 关键字；</li>
</ol>
</li>
<li>
<ol start="2">
<li><code>await</code> 表示在这个地方<strong>等待子函数执行完成</strong>，再往下执行。（在并发操作中，把程序控制权交给主程序，让他分配其他协程执行。） <code>await</code> 只能在带有 <code>async</code> 关键字的函数中运行。</li>
</ol>
</li>
</ul>
</blockquote>
<pre><code class="language-python"># 异步io简单实现
import asyncio
import time
# 获取超级事件循环
# event:事件 loop:环
loop = asyncio.get_event_loop()
urls = [
    f&quot;https://skyxinye.xyz/#{page}&quot;
    for page in range(1, 99)
]

# 定义协程函数
async def myfunc(url):
    await time.sleep(2) # 这样写不行,因为 time.sleep 不是异步函数,不能中途跳出执行另一个协程.
    await asyncio.sleep(2) # 用协程函数.
# 创建 task 列表
# create:创造
tasks = [
    # 在超级循环中创造多个任务,并设置等待任务完成.(如果协程函数中没有同步操作的话就不用设置)
    # 任务没有运行
    loop.create_task(asyncio.wait(myfunc(url)))
    for url in urls
]
# 执行异步事件列表,运行直到完成,如果是协程列表就要设置等待事件完成.
loop.run_until_complete(asyncio.wait(tasks))
</code></pre>
<h4 id="利用-aiohttp-模块发送网络请求"><a class="header" href="#利用-aiohttp-模块发送网络请求">利用 <code>aiohttp</code> 模块发送网络请求</a></h4>
<pre><code class="language-python"># 异步模块 aiohttp 使用
import asyncio
import aiohttp


# Http请求 协程函数
# GET
async def async_get(url):
    &quot;&quot;&quot;
    aiohttp:发送http请求
    1.创建一个ClientSession对象
    2.通过ClientSession对象去发送请求（get, post, delete等）
    3.await 异步等待返回结果
    &quot;&quot;&quot;
    print(&quot;Get Url:&quot;, url)
    async with aiohttp.ClientSession() as se:
        async with se.get(url) as resp:
            result = await resp.text()
            print(len(result))

urls = [
    f&quot;https://skyxinye.xyz/#{page}&quot;
    for page in range(1, 99999)
]

# 超级循环
loop = asyncio.get_event_loop()
# 事件列表
tasks=[
    loop.create_task(async_get(url))
    for url in urls 
]
# 用 wait 方法遍历事件列表.协程列表需要设置等待运行完成
loop.run_until_complete(asyncio.wait(tasks))

&quot;&quot;&quot;
    异步协程不用事件列表的另一种实现方法
    aiohttp:发送POST请求
&quot;&quot;&quot;
# POST
async def main():
    data = {'key1': 'value1', 'key2': 'value2'}
    url = 'http://httpbin.org/post'
    async with aiohttp.ClientSession() as session:
        async with session.post(url, data=data) as res:
            print(res.status)
            print(await res.text())
loop = asyncio.get_event_loop()
# 如果是单个协程就不需要设置 asyncio.wait()
task = loop.create_task(main())
loop.run_until_complete(task)
</code></pre>
<h4 id="利用-aiofile-异步操作文件"><a class="header" href="#利用-aiofile-异步操作文件">利用 <code>aiofile</code> 异步操作文件</a></h4>
<pre><code class="language-python">import aiofiles
import asyncio

async def write():
    async with aiofiles.open(&quot;test.txt&quot;,&quot;w&quot;,encoding=&quot;utf8&quot;) as fp:
        await fp.write(&quot;异步写入文件&quot;)
        print(&quot;文件写入成功&quot;)

async def read():
    async with aiofiles.open(&quot;test.txt&quot;,&quot;r&quot;,encoding=&quot;utf8&quot;) as fp:
        content = await fp.read()
        print(content)

async def read2_demo():
    async with aiofiles.open(&quot;text.txt&quot;,&quot;r&quot;,encoding=&quot;utf-8&quot;) as fp:
        # 读取每行
        async for line in fp:
            print(line)

if __name__==&quot;__main__&quot;:
    asyncio.run(write())
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../博客文章/_posts/Python/Flask-Web-note.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../../博客文章/_posts/Python/Python-Tkinter-GUI.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../博客文章/_posts/Python/Flask-Web-note.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../../博客文章/_posts/Python/Python-Tkinter-GUI.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../elasticlunr.min.js"></script>
        <script src="../../../mark.min.js"></script>
        <script src="../../../searcher.js"></script>

        <script src="../../../clipboard.min.js"></script>
        <script src="../../../highlight.js"></script>
        <script src="../../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
